<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
    <script type="text/javascript" src="js/jszip.js"></script>
    <script type="text/javascript" src="js/FileSaver.js"></script>
    <!--
        A template from below:
    BeaqleJS - HTML5 and JavaScript framework for listening tests, <https://github.com/HSU-ANT/beaqlejs>

    This file and all corresponding parts of BeaqleJS are published under the GPLv3 license, <http://www.gnu.org/licenses/>    
    -->


    <title>笛箫协会乐谱库</title>

    <!-- load the test config file -->
    <!-- <script src="config/example_config_mushra.js" type="text/javascript"></script> -->
    <!-- -->



    <link type="text/css" href="css/smoothness/jquery-ui-1.8.18.custom.css" rel="Stylesheet" />
    <link type="text/css" href="css/styles.css" rel="Stylesheet" />

    <!-- <script src="js/jquery.js" type="text/javascript"></script>
    <script src="js/jquery-ui.custom.min.js" type="text/javascript" ></script>
    <script src="js/beaqle.js" type="text/javascript"></script> -->


</head>

<body>


    <div style="text-align:center">
        <br />
        <br />
        请选择需要查看的乐曲：
        <input type="radio" name="pieces" value="印象国乐大曲" checked="checked">印象国乐大曲
        <input type="radio" name="pieces" value="瑶族舞曲">瑶族舞曲
        <input type="radio" name="pieces" value="穿越时空的思念">穿越时空的思念
        <input type="radio" name="pieces" value="花好月圆">花好月圆
        <input type="radio" name="pieces" value="台湾追想曲">台湾追想曲
        <br />
        <br />
        请选择需要查看的声部：
        <input type="radio" name="ins" value="总谱" checked="checked">总谱
        <input type="radio" name="ins" value="吹管">吹管
        <input type="radio" name="ins" value="弹拨">弹拨
        <input type="radio" name="ins" value="弦乐">弦乐
        <input type="radio" name="ins" value="打击">打击
        <br />
        <br />
        <button id="BtnStart" onclick="DownloadFiles()">Go！</button>
    </div>
    <br />
    <br />

    <!-- this button starts the first test -->


    <script language="javascript">
        const cipherdict={
            "印象国乐大曲": "qaEgCij57YJVAz0uUeOG",
            "瑶族舞曲": "itkXo4rCw0jmUd3nFVpb",
            "穿越时空的思念": "MQlDvnriRpb6du3HOfI9",
            "花好月圆": "XLptxAE1Z45uohqHcQr9",
            "台湾追想曲": "rsvgotidx7wDcHuJAbMF"
        }
        function DownloadFiles() {
            var storage = window.sessionStorage;
            if (storage.getItem("HasAccess") == "OK") {
                var zip = new JSZip();
                // prompt("Prepare zip");
                var pieceselectlist = document.getElementsByName("pieces");
                var pieceselect = "";
                //alert(pieceselectlist);
                for (var i = 0; i < pieceselectlist.length; i++) {
                    // alert(pieceselectlist[i].checked);
                    if (pieceselectlist[i].checked) {
                        pieceselect = pieceselectlist[i].value; break;
                    }
                }
                // alert(pieceselect);
                var insselectlist = document.getElementsByName("ins");
                var insselect = "";
                for (var i = 0; i < insselectlist.length; i++) {
                    if (insselectlist[i].checked) {
                        insselect = insselectlist[i].value; break;
                    }
                }

                alert(`下载 ${pieceselect}-${insselect}的所有分谱`);

                window.location.href = "scores/"+cipherdict[pieceselect]+"/"+insselect+".zip";
            } else {
                alert("No Access. Please log in through the index page.")
            }
        }
    </script>

</body>

</html>